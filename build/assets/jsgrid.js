//# sourceMappingURL=jsgrid.js.map
(function(f,b,l){function h(c,g){var a=b(c);a.data("JSGrid",this);this._container=a;this.data=[];this.fields=[];this._sortField=this._editingRow=null;this._sortOrder="asc";this._firstDisplayingPage=1;this._init(g);this.render()}var d=function(c,g){return b.isFunction(c)?c.apply(g,b.makeArray(arguments).slice(2)):c},a={loadData:b.noop,insertItem:b.noop,updateItem:b.noop,deleteItem:b.noop};h.prototype={width:"auto",height:"auto",updateOnResize:!0,rowClass:b.noop,rowRenderer:null,rowClick:function(c){this.editing&&
this.editItem(b(c.event.target).closest("tr"))},rowDoubleClick:b.noop,noDataContent:"Not found",noDataRowClass:"jsgrid-nodata-row",heading:!0,headerRowRenderer:null,headerRowClass:"jsgrid-header-row",filtering:!1,filterRowRenderer:null,filterRowClass:"jsgrid-filter-row",inserting:!1,insertRowRenderer:null,insertRowClass:"jsgrid-insert-row",editing:!1,editRowRenderer:null,editRowClass:"jsgrid-edit-row",confirmDeleting:!0,deleteConfirm:"Are you sure?",selecting:!0,selectedRowClass:"jsgrid-selected-row",
oddRowClass:"jsgrid-row",evenRowClass:"jsgrid-alt-row",sorting:!1,sortableClass:"jsgrid-header-sortable",sortAscClass:"jsgrid-header-sort jsgrid-header-sort-asc",sortDescClass:"jsgrid-header-sort jsgrid-header-sort-desc",paging:!1,pagerContainer:null,pageIndex:1,pageSize:20,pageButtonCount:15,pagerFormat:"Pages: {first} {prev} {pages} {next} {last} &nbsp;&nbsp; {pageIndex} of {pageCount}",pagePrevText:"Prev",pageNextText:"Next",pageFirstText:"First",pageLastText:"Last",pageNavigatorNextText:"...",
pageNavigatorPrevText:"...",pagerContainerClass:"jsgrid-pager-container",pagerClass:"jsgrid-pager",pagerNavButtonClass:"jsgrid-pager-nav-button",pagerNavButtonInactiveClass:"jsgrid-pager-nav-inactive-button",pageClass:"jsgrid-pager-page",currentPageClass:"jsgrid-pager-current-page",customLoading:!1,pageLoading:!1,autoload:!1,controller:a,loadIndication:!0,loadIndicationDelay:500,loadMessage:"Please, wait...",loadShading:!0,invalidMessage:"Invalid data entered!",invalidNotify:function(c){c=b.map(c.errors,
function(c){return c.message||null});f.alert([this.invalidMessage].concat(c).join("\n"))},onRefreshing:b.noop,onRefreshed:b.noop,onItemDeleting:b.noop,onItemDeleted:b.noop,onItemInserting:b.noop,onItemInserted:b.noop,onItemEditing:b.noop,onItemUpdating:b.noop,onItemUpdated:b.noop,onItemInvalid:b.noop,onDataLoading:b.noop,onDataLoaded:b.noop,onOptionChanging:b.noop,onOptionChanged:b.noop,onError:b.noop,invalidClass:"jsgrid-invalid",containerClass:"jsgrid",tableClass:"jsgrid-table",gridHeaderClass:"jsgrid-grid-header",
gridBodyClass:"jsgrid-grid-body",_init:function(c){b.extend(this,c);this._initLoadStrategy();this._initController();this._initFields();this._attachWindowLoadResize();this._attachWindowResizeCallback()},loadStrategy:function(){return this.pageLoading?new jsGrid.loadStrategies.PageLoadingStrategy(this):new jsGrid.loadStrategies.DirectLoadingStrategy(this)},_initLoadStrategy:function(){this._loadStrategy=d(this.loadStrategy,this)},_initController:function(){this._controller=b.extend({},a,d(this.controller,
this))},loadIndicator:function(c){return new jsGrid.LoadIndicator(c)},validation:function(c){return jsGrid.Validation&&new jsGrid.Validation(c)},_initFields:function(){var c=this;c.fields=b.map(c.fields,function(g){b.isPlainObject(g)&&(g=new (g.type&&jsGrid.fields[g.type]||jsGrid.Field)(g));g._grid=c;return g})},_attachWindowLoadResize:function(){b(f).on("load",b.proxy(this._refreshSize,this))},_attachWindowResizeCallback:function(){if(this.updateOnResize)b(f).on("resize",b.proxy(this._refreshSize,
this))},_detachWindowResizeCallback:function(){b(f).off("resize",this._refreshSize)},option:function(c,g){var a;if(1===arguments.length)return this[c];a={option:c,oldValue:this[c],newValue:g};this._callEventHandler(this.onOptionChanging,a);this._handleOptionChange(a.option,a.newValue);this._callEventHandler(this.onOptionChanged,{option:a.option,value:a.newValue})},fieldOption:function(c,g,a){c=this._normalizeField(c);if(2===arguments.length)return c[g];c[g]=a;this._renderGrid()},_handleOptionChange:function(c,
g){this[c]=g;switch(c){case "width":case "height":this._refreshSize();break;case "rowClass":case "rowRenderer":case "rowClick":case "rowDoubleClick":case "noDataText":case "noDataRowClass":case "noDataContent":case "selecting":case "selectedRowClass":case "oddRowClass":case "evenRowClass":this._refreshContent();break;case "pageButtonCount":case "pagerFormat":case "pagePrevText":case "pageNextText":case "pageFirstText":case "pageLastText":case "pageNavigatorNextText":case "pageNavigatorPrevText":case "pagerClass":case "pagerNavButtonClass":case "pageClass":case "currentPageClass":case "pagerRenderer":this._refreshPager();
break;case "fields":this._initFields();this.render();break;case "data":case "editing":case "heading":case "filtering":case "inserting":case "paging":this.refresh();break;case "loadStrategy":case "pageLoading":this._initLoadStrategy();this.search();break;case "pageIndex":this.openPage(g);break;case "pageSize":this.refresh();this.search();break;case "editRowRenderer":case "editRowClass":this.cancelEdit();break;case "updateOnResize":this._detachWindowResizeCallback();this._attachWindowResizeCallback();
break;case "invalidNotify":case "invalidMessage":break;default:this.render()}},destroy:function(){this._detachWindowResizeCallback();this._clear();this._container.removeData("JSGrid")},render:function(){this._renderGrid();return this.autoload?this.loadData():b.Deferred().resolve().promise()},_renderGrid:function(){this._clear();this._container.addClass(this.containerClass).css("position","relative").append(this._createHeader()).append(this._createBody());this._pagerContainer=this._createPagerContainer();
this._loadIndicator=this._createLoadIndicator();this._validation=this._createValidation();this.refresh()},_createLoadIndicator:function(){return d(this.loadIndicator,this,{message:this.loadMessage,shading:this.loadShading,container:this._container})},_createValidation:function(){return d(this.validation,this)},_clear:function(){this.cancelEdit();clearTimeout(this._loadingTimer);this._pagerContainer&&this._pagerContainer.empty();this._container.empty().css({position:"",width:"",height:""})},_createHeader:function(){var c=
this._headerRow=this._createHeaderRow(),g=this._filterRow=this._createFilterRow(),a=this._insertRow=this._createInsertRow(),c=this._headerGrid=b("<table>").addClass(this.tableClass).append(c).append(g).append(a);return this._header=b("<div>").addClass(this.gridHeaderClass).addClass(this._scrollBarWidth()?"jsgrid-header-scrollbar":"").append(c)},_createBody:function(){var c=this._content=b("<tbody>"),c=this._bodyGrid=b("<table>").addClass(this.tableClass).append(c);return this._body=b("<div>").addClass(this.gridBodyClass).append(c).on("scroll",
b.proxy(function(c){this._header.scrollLeft(c.target.scrollLeft)},this))},_createPagerContainer:function(){var c=this.pagerContainer||b("<div>").appendTo(this._container);return b(c).addClass(this.pagerContainerClass)},_eachField:function(c){var g=this;b.each(this.fields,function(a,b){b.visible&&c.call(g,b,a)})},_createHeaderRow:function(){if(b.isFunction(this.headerRowRenderer))return b(this.headerRowRenderer());var c=b("<tr>").addClass(this.headerRowClass);this._eachField(function(g,a){var e=this._prepareCell("<th>",
g,"headercss").append(g.headerTemplate?g.headerTemplate():"").appendTo(c);if(this.sorting&&g.sorting)e.addClass(this.sortableClass).on("click",b.proxy(function(){this.sort(a)},this))});return c},_prepareCell:function(c,g,a){return b(c).css("width",g.width).addClass(a&&g[a]||g.css).addClass(g.align?"jsgrid-align-"+g.align:"")},_createFilterRow:function(){if(b.isFunction(this.filterRowRenderer))return b(this.filterRowRenderer());var c=b("<tr>").addClass(this.filterRowClass);this._eachField(function(g){this._prepareCell("<td>",
g,"filtercss").append(g.filterTemplate?g.filterTemplate():"").appendTo(c)});return c},_createInsertRow:function(){if(b.isFunction(this.insertRowRenderer))return b(this.insertRowRenderer());var c=b("<tr>").addClass(this.insertRowClass);this._eachField(function(g){this._prepareCell("<td>",g,"insertcss").append(g.insertTemplate?g.insertTemplate():"").appendTo(c)});return c},_callEventHandler:function(c,g){c.call(this,b.extend(g,{grid:this}));return g},reset:function(){this._resetSorting();this._resetPager();
this.refresh()},_resetPager:function(){this._firstDisplayingPage=1;this._setPage(1)},_resetSorting:function(){this._sortField=null;this._sortOrder="asc";this._clearSortingCss()},refresh:function(){this._callEventHandler(this.onRefreshing);this.cancelEdit();this._refreshHeading();this._refreshFiltering();this._refreshInserting();this._refreshContent();this._refreshPager();this._refreshSize();this._callEventHandler(this.onRefreshed)},_refreshHeading:function(){this._headerRow.toggle(this.heading)},
_refreshFiltering:function(){this._filterRow.toggle(this.filtering)},_refreshInserting:function(){this._insertRow.toggle(this.inserting)},_refreshContent:function(){var c=this._content;c.empty();if(!this.data.length)return c.append(this._createNoDataRow()),this;for(var g=this._loadStrategy.firstDisplayIndex(),a=this._loadStrategy.lastDisplayIndex();g<a;g++)c.append(this._createRow(this.data[g],g))},_createNoDataRow:function(){var c=d(this.noDataContent,this),g=0;this._eachField(function(){g++});return b("<tr>").addClass(this.noDataRowClass).append(b("<td>").attr("colspan",
g).append(c))},_createNoDataContent:function(){return b.isFunction(this.noDataRenderer)?this.noDataRenderer():this.noDataText},_createRow:function(c,g){var a;b.isFunction(this.rowRenderer)?a=b(this.rowRenderer(c,g)):(a=b("<tr>"),this._renderCells(a,c));a.addClass(this._getRowClasses(c,g)).data("JSGridItem",c).on("click",b.proxy(function(a){this.rowClick({item:c,itemIndex:g,event:a})},this)).on("dblclick",b.proxy(function(a){this.rowDoubleClick({item:c,itemIndex:g,event:a})},this));this.selecting&&
this._attachRowHover(a);return a},_getRowClasses:function(c,a){var b=[];b.push((a+1)%2?this.oddRowClass:this.evenRowClass);b.push(d(this.rowClass,this,c,a));return b.join(" ")},_attachRowHover:function(c){var a=this.selectedRowClass;c.hover(function(){b(this).addClass(a)},function(){b(this).removeClass(a)})},_renderCells:function(c,a){this._eachField(function(b){c.append(this._createCell(a,b))});return this},_createCell:function(c,a){var m;m=this._getItemFieldValue(c,a);m=b.isFunction(a.cellRenderer)?
b(a.cellRenderer(m,c)):b("<td>").append(a.itemTemplate?a.itemTemplate(m,c):m);return this._prepareCell(m,a)},_getItemFieldValue:function(c,a){for(var b=a.name.split("."),e=c[b.shift()];e&&b.length;)e=e[b.shift()];return e},_setItemFieldValue:function(c,a,b){a=a.name.split(".");for(var e=c,d=a[0];e&&a.length;)c=e,d=a.shift(),e=c[d];if(!e)for(;a.length;)c=c[d]={},d=a.shift();c[d]=b},sort:function(c,a){b.isPlainObject(c)&&(a=c.order,c=c.field);this._clearSortingCss();this._setSortingParams(c,a);this._setSortingCss();
return this._loadStrategy.sort()},_clearSortingCss:function(){this._headerRow.find("th").removeClass(this.sortAscClass).removeClass(this.sortDescClass)},_setSortingParams:function(c,a){c=this._normalizeField(c);a=a||(this._sortField===c?this._reversedSortOrder(this._sortOrder):"asc");this._sortField=c;this._sortOrder=a},_normalizeField:function(c){return b.isNumeric(c)?this.fields[c]:"string"===typeof c?b.grep(this.fields,function(a){return a.name===c})[0]:c},_reversedSortOrder:function(c){return"asc"===
c?"desc":"asc"},_setSortingCss:function(){var c=b.inArray(this._sortField,b.grep(this.fields,function(c){return c.visible}));this._headerRow.find("th").eq(c).addClass("asc"===this._sortOrder?this.sortAscClass:this.sortDescClass)},_sortData:function(){var c=this._sortFactor(),a=this._sortField;a&&this.data.sort(function(b,e){return c*a.sortingFunc(b[a.name],e[a.name])})},_sortFactor:function(){return"asc"===this._sortOrder?1:-1},_itemsCount:function(){return this._loadStrategy.itemsCount()},_pagesCount:function(){var c=
this._itemsCount(),a=this.pageSize;return Math.floor(c/a)+(c%a?1:0)},_refreshPager:function(){var c=this._pagerContainer;c.empty();this.paging&&c.append(this._createPager());var a=this.paging&&1<this._pagesCount();c.toggle(a)},_createPager:function(){var c;c=b.isFunction(this.pagerRenderer)?b(this.pagerRenderer({pageIndex:this.pageIndex,pageCount:this._pagesCount()})):b("<div>").append(this._createPagerByFormat());c.addClass(this.pagerClass);return c},_createPagerByFormat:function(){var c=this.pageIndex,
a=this._pagesCount(),m=this._itemsCount(),e=this.pagerFormat.split(" ");return b.map(e,b.proxy(function(e){var d=e;"{pages}"===e?d=this._createPages():"{first}"===e?d=this._createPagerNavButton(this.pageFirstText,1,1<c):"{prev}"===e?d=this._createPagerNavButton(this.pagePrevText,c-1,1<c):"{next}"===e?d=this._createPagerNavButton(this.pageNextText,c+1,c<a):"{last}"===e?d=this._createPagerNavButton(this.pageLastText,a,c<a):"{pageIndex}"===e?d=c:"{pageCount}"===e?d=a:"{itemCount}"===e&&(d=m);return b.isArray(d)?
d.concat([" "]):[d," "]},this))},_createPages:function(){var c=this._pagesCount(),a=this.pageButtonCount,b=this._firstDisplayingPage,e=[];1<b&&e.push(this._createPagerPageNavButton(this.pageNavigatorPrevText,this.showPrevPages));for(var d=0,k=b;d<a&&k<=c;d++,k++)e.push(k===this.pageIndex?this._createPagerCurrentPage():this._createPagerPage(k));b+a-1<c&&e.push(this._createPagerPageNavButton(this.pageNavigatorNextText,this.showNextPages));return e},_createPagerNavButton:function(c,a,e){return this._createPagerButton(c,
this.pagerNavButtonClass+(e?"":" "+this.pagerNavButtonInactiveClass),e?function(){this.openPage(a)}:b.noop)},_createPagerPageNavButton:function(c,a){return this._createPagerButton(c,this.pagerNavButtonClass,a)},_createPagerPage:function(c){return this._createPagerButton(c,this.pageClass,function(){this.openPage(c)})},_createPagerButton:function(c,a,e){c=b("<a>").attr("href","javascript:void(0);").html(c).on("click",b.proxy(e,this));return b("<span>").addClass(a).append(c)},_createPagerCurrentPage:function(){return b("<span>").addClass(this.pageClass).addClass(this.currentPageClass).text(this.pageIndex)},
_refreshSize:function(){this._refreshHeight();this._refreshWidth()},_refreshWidth:function(){var c=this._headerGrid,a=this._bodyGrid,b=this.width;"auto"===b&&(c.width("auto"),b=c.outerWidth());c.width("");a.width("");this._container.width(b);b=c.outerWidth();a.width(b)},_scrollBarWidth:function(){var c;return function(){if(void 0===c){var a=b("<div style='width:50px;height:50px;overflow:hidden;position:absolute;top:-10000px;left:-10000px;'></div>"),e=b("<div style='height:100px;'></div>");a.append(e).appendTo("body");
var d=e.innerWidth();a.css("overflow-y","auto");e=e.innerWidth();a.remove();c=d-e}return c}}(),_refreshHeight:function(){var c=this._container,a=this._pagerContainer,b=this.height,e;c.height(b);"auto"!==b&&(b=c.height(),e=this._header.outerHeight(!0),a.parents(c).length&&(e+=a.outerHeight(!0)),this._body.outerHeight(b-e))},showPrevPages:function(){var c=this._firstDisplayingPage,a=this.pageButtonCount;this._firstDisplayingPage=c>a?c-a:1;this._refreshPager()},showNextPages:function(){var c=this._firstDisplayingPage,
a=this.pageButtonCount,b=this._pagesCount();this._firstDisplayingPage=c+2*a>b?b-a+1:c+a;this._refreshPager()},openPage:function(c){1>c||c>this._pagesCount()||(this._setPage(c),this._loadStrategy.openPage(c))},_setPage:function(c){var a=this._firstDisplayingPage,b=this.pageButtonCount;this.pageIndex=c;c<a&&(this._firstDisplayingPage=c);c>a+b-1&&(this._firstDisplayingPage=c-b+1)},_controllerCall:function(c,a,e,d){if(e)return b.Deferred().reject().promise();this._showLoading();e=this._controller;if(!e||
!e[c])throw Error("controller has no method '"+c+"'");return b.when(e[c](a)).done(b.proxy(d,this)).fail(b.proxy(this._errorHandler,this)).always(b.proxy(this._hideLoading,this))},_errorHandler:function(){this._callEventHandler(this.onError,{args:b.makeArray(arguments)})},_showLoading:function(){this.loadIndication&&(clearTimeout(this._loadingTimer),this._loadingTimer=setTimeout(b.proxy(function(){this._loadIndicator.show()},this),this.loadIndicationDelay))},_hideLoading:function(){this.loadIndication&&
(clearTimeout(this._loadingTimer),this._loadIndicator.hide())},search:function(c){this._resetSorting();this._resetPager();return this.loadData(c)},loadData:function(c){c=c||(this.filtering?this.getFilter():{});b.extend(c,this._loadStrategy.loadParams(),this._sortingParams());var a=this._callEventHandler(this.onDataLoading,{filter:c});return this._controllerCall("loadData",c,a.cancel,function(c){c&&(this._loadStrategy.finishLoad(c),this._callEventHandler(this.onDataLoaded,{data:c}))})},getFilter:function(){var c=
{};this._eachField(function(a){a.filtering&&this._setItemFieldValue(c,a,a.filterValue())});return c},_sortingParams:function(){return this.sorting&&this._sortField?{sortField:this._sortField.name,sortOrder:this._sortOrder}:{}},getSorting:function(){var c=this._sortingParams();return{field:c.sortField,order:c.sortOrder}},clearFilter:function(){var c=this._createFilterRow();this._filterRow.replaceWith(c);this._filterRow=c;return this.search()},insertItem:function(c){var a=c||this._getValidatedInsertItem();
if(!a)return b.Deferred().reject().promise();c=this._callEventHandler(this.onItemInserting,{item:a});return this._controllerCall("insertItem",a,c.cancel,function(c){c=c||a;this._loadStrategy.finishInsert(c);this._callEventHandler(this.onItemInserted,{item:c})})},_getValidatedInsertItem:function(){var c=this._getInsertItem();return this._validateItem(c,this._insertRow)?c:null},_getInsertItem:function(){var c={};this._eachField(function(a){a.inserting&&this._setItemFieldValue(c,a,a.insertValue())});
return c},_validateItem:function(c,a){var e=[],d={item:c,itemIndex:this._rowIndex(a),row:a};this._eachField(function(k,f){if(k.validate){var h=this._validation.validate(b.extend({value:this._getItemFieldValue(c,k),rules:k.validate},d));this._setCellValidity(a.children().eq(f),h);h.length&&e.push.apply(e,b.map(h,function(a){return{field:k,message:a}}))}});if(!e.length)return!0;var k=b.extend({errors:e},d);this._callEventHandler(this.onItemInvalid,k);this.invalidNotify(k);return!1},_setCellValidity:function(a,
b){a.toggleClass(this.invalidClass,!!b.length).attr("title",b.join("\n"))},clearInsert:function(){var a=this._createInsertRow();this._insertRow.replaceWith(a);this._insertRow=a;this.refresh()},editItem:function(a){a=this.rowByItem(a);a.length&&this._editRow(a)},rowByItem:function(a){return a.jquery||a.nodeType?b(a):this._content.find("tr").filter(function(){return b.data(this,"JSGridItem")===a})},_editRow:function(a){if(this.editing){var b=a.data("JSGridItem");this._callEventHandler(this.onItemEditing,
{row:a,item:b,itemIndex:this._itemIndex(b)}).cancel||(this._editingRow&&this.cancelEdit(),b=this._createEditRow(b),this._editingRow=a,a.hide(),b.insertBefore(a),a.data("JSGridEditRow",b))}},_createEditRow:function(a){if(b.isFunction(this.editRowRenderer))return b(this.editRowRenderer(a,this._itemIndex(a)));var e=b("<tr>").addClass(this.editRowClass);this._eachField(function(b){var d=this._getItemFieldValue(a,b);this._prepareCell("<td>",b,"editcss").append(b.editTemplate?b.editTemplate(d,a):"").appendTo(e)});
return e},updateItem:function(a,b){1===arguments.length&&(b=a);var e=a?this.rowByItem(a):this._editingRow;if(b=b||this._getValidatedEditedItem())return this._updateRow(e,b)},_getValidatedEditedItem:function(){var a=this._getEditedItem();return this._validateItem(a,this._getEditRow())?a:null},_updateRow:function(a,e){var d=a.data("JSGridItem"),k=this._itemIndex(d),f=b.extend(!0,{},d);b.extend(!0,d,e);var h=this._callEventHandler(this.onItemUpdating,{row:a,item:d,itemIndex:k,previousItem:f});return this._controllerCall("updateItem",
d,h.cancel,function(b){b=b||d;var e=this._finishUpdate(a,b,k);this._callEventHandler(this.onItemUpdated,{row:e,item:b,itemIndex:k,previousItem:f})})},_rowIndex:function(a){return this._content.children().index(b(a))},_itemIndex:function(a){return b.inArray(a,this.data)},_finishUpdate:function(a,b,e){this.cancelEdit();this.data[e]=b;b=this._createRow(b,e);a.replaceWith(b);return b},_getEditedItem:function(){var a={};this._eachField(function(b){b.editing&&this._setItemFieldValue(a,b,b.editValue())});
return a},cancelEdit:function(){this._editingRow&&(this._getEditRow().remove(),this._editingRow.show(),this._editingRow=null)},_getEditRow:function(){return this._editingRow.data("JSGridEditRow")},deleteItem:function(a){a=this.rowByItem(a);if(a.length&&(!this.confirmDeleting||f.confirm(d(this.deleteConfirm,this,a.data("JSGridItem")))))return this._deleteRow(a)},_deleteRow:function(a){var b=a.data("JSGridItem"),e=this._itemIndex(b),d=this._callEventHandler(this.onItemDeleting,{row:a,item:b,itemIndex:e});
return this._controllerCall("deleteItem",b,d.cancel,function(){this._loadStrategy.finishDelete(b,e);this._callEventHandler(this.onItemDeleted,{row:a,item:b,itemIndex:e})})}};b.fn.jsGrid=function(a){var e=b.makeArray(arguments).slice(1),d=this;this.each(function(){var k=b(this),f=k.data("JSGrid");if(f)if("string"===typeof a){if(k=f[a].apply(f,e),void 0!==k&&k!==f)return d=k,!1}else f._detachWindowResizeCallback(),f._init(a),f.render();else new h(k,a)});return d};var e={},k={},n=function(a,e){b.each(e,
function(e,d){b.isPlainObject(d)?n(a[e]||a[e[0].toUpperCase()+e.slice(1)],d):a.hasOwnProperty(e)?a[e]=d:a.prototype[e]=d})};f.jsGrid={Grid:h,fields:e,setDefaults:function(a,d){var k;b.isPlainObject(a)?k=h.prototype:(k=e[a].prototype,a=d||{});b.extend(k,a)},locales:k,locale:function(a){var e=b.isPlainObject(a)?a:k[a];if(!e)throw Error("unknown locale "+a);n(jsGrid,e)}}})(window,jQuery);
(function(f,b,l){function h(b){this._init(b)}h.prototype={container:"body",message:"Loading...",shading:!0,zIndex:1E3,shaderClass:"jsgrid-load-shader",loadPanelClass:"jsgrid-load-panel",_init:function(d){b.extend(!0,this,d);this._initContainer();this._initShader();this._initLoadPanel()},_initContainer:function(){this._container=b(this.container)},_initShader:function(){this.shading&&(this._shader=b("<div>").addClass(this.shaderClass).hide().css({position:"absolute",top:0,right:0,bottom:0,left:0,zIndex:this.zIndex}).appendTo(this._container))},
_initLoadPanel:function(){this._loadPanel=b("<div>").addClass(this.loadPanelClass).text(this.message).hide().css({position:"absolute",top:"50%",left:"50%",zIndex:this.zIndex}).appendTo(this._container)},show:function(){var b=this._loadPanel.show(),a=b.outerWidth(),e=b.outerHeight();b.css({marginTop:-e/2,marginLeft:-a/2});this._shader.show()},hide:function(){this._loadPanel.hide();this._shader.hide()}};f.LoadIndicator=h})(jsGrid,jQuery);
(function(f,b,l){function h(a){this._grid=a}function d(a){this._grid=a;this._itemsCount=0}h.prototype={firstDisplayIndex:function(){var a=this._grid;return a.option("paging")?(a.option("pageIndex")-1)*a.option("pageSize"):0},lastDisplayIndex:function(){var a=this._grid,b=a.option("data").length;return a.option("paging")?Math.min(a.option("pageIndex")*a.option("pageSize"),b):b},itemsCount:function(){return this._grid.option("data").length},openPage:function(a){this._grid.refresh()},loadParams:function(){return{}},
sort:function(){this._grid._sortData();this._grid.refresh();return b.Deferred().resolve().promise()},finishLoad:function(a){this._grid.option("data",a)},finishInsert:function(a){var b=this._grid;b.option("data").push(a);b.refresh()},finishDelete:function(a,b){var d=this._grid;d.option("data").splice(b,1);d.reset()}};d.prototype={firstDisplayIndex:function(){return 0},lastDisplayIndex:function(){return this._grid.option("data").length},itemsCount:function(){return this._itemsCount},openPage:function(a){this._grid.loadData()},
loadParams:function(){var a=this._grid;return{pageIndex:a.option("pageIndex"),pageSize:a.option("pageSize")}},sort:function(){return this._grid.loadData()},finishLoad:function(a){this._itemsCount=a.itemsCount;this._grid.option("data",a.data)},finishInsert:function(a){this._grid.search()},finishDelete:function(a,b){this._grid.search()}};f.loadStrategies={DirectLoadingStrategy:h,PageLoadingStrategy:d}})(jsGrid,jQuery);
(function(f,b,l){var h=function(b){return"undefined"!==typeof b&&null!==b};f.sortStrategies={string:function(b,a){return h(b)||h(a)?h(b)?h(a)?(""+b).localeCompare(""+a):1:-1:0},number:function(b,a){return b-a},date:function(b,a){return b-a},numberAsString:function(b,a){return parseFloat(b)-parseFloat(a)}}})(jsGrid,jQuery);
(function(f,b,l){function h(a){this._init(a)}h.prototype={_init:function(a){b.extend(!0,this,a)},validate:function(a){var e=[];b.each(this._normalizeRules(a.rules),function(d,f){if(!f.validator(a.value,a.item,f.param)){var c=b.isFunction(f.message)?f.message(a.value,a.item):f.message;e.push(c)}});return e},_normalizeRules:function(a){b.isArray(a)||(a=[a]);return b.map(a,b.proxy(function(a){return this._normalizeRule(a)},this))},_normalizeRule:function(a){"string"===typeof a&&(a={validator:a});b.isFunction(a)&&
(a={validator:a});if(b.isPlainObject(a))a=b.extend({},a);else throw Error("wrong validation config specified");return b.isFunction(a.validator)?a:this._applyNamedValidator(a,a.validator)},_applyNamedValidator:function(a,e){delete a.validator;var k=d[e];if(!k)throw Error('unknown validator "'+e+'"');b.isFunction(k)&&(k={validator:k});return b.extend({},k,a)}};f.Validation=h;var d={required:{message:"Field is required",validator:function(a){return a!==l&&null!==a&&""!==a}},rangeLength:{message:"Field value length is out of the defined range",
validator:function(a,b,d){return a.length>=d[0]&&a.length<=d[1]}},minLength:{message:"Field value is too long",validator:function(a,b,d){return a.length>=d}},maxLength:{message:"Field value is too short",validator:function(a,b,d){return a.length<=d}},pattern:{message:"Field value is not matching the defined pattern",validator:function(a,b,d){"string"===typeof d&&(d=new RegExp("^(?:"+d+")$"));return d.test(a)}},range:{message:"Field value is out of the defined range",validator:function(a,b,d){return a>=
d[0]&&a<=d[1]}},min:{message:"Field value is too large",validator:function(a,b,d){return a>=d}},max:{message:"Field value is too small",validator:function(a,b,d){return a<=d}}};f.validators=d})(jsGrid,jQuery);
(function(f,b,l){function h(d){b.extend(!0,this,d);this.sortingFunc=this._getSortingFunc()}h.prototype={name:"",title:null,css:"",align:"",width:100,visible:!0,filtering:!0,inserting:!0,editing:!0,sorting:!0,sorter:"string",headerTemplate:function(){return this.title===l||null===this.title?this.name:this.title},itemTemplate:function(b,a){return b},filterTemplate:function(){return""},insertTemplate:function(){return""},editTemplate:function(b,a){this._value=b;return this.itemTemplate(b,a)},filterValue:function(){return""},
insertValue:function(){return""},editValue:function(){return this._value},_getSortingFunc:function(){var d=this.sorter;if(b.isFunction(d))return d;if("string"===typeof d)return f.sortStrategies[d];throw Error('wrong sorter for the field "'+this.name+'"!');}};f.Field=h})(jsGrid,jQuery);
(function(f,b,l){function h(a){d.call(this,a)}var d=f.Field;h.prototype=new d({autosearch:!0,readOnly:!1,filterTemplate:function(){if(!this.filtering)return"";var a=this._grid,b=this.filterControl=this._createTextBox();if(this.autosearch)b.on("keypress",function(b){13===b.which&&(a.search(),b.preventDefault())});return b},insertTemplate:function(){return this.inserting?this.insertControl=this._createTextBox():""},editTemplate:function(a){if(!this.editing)return this.itemTemplate(a);var b=this.editControl=
this._createTextBox();b.val(a);return b},filterValue:function(){return this.filterControl.val()},insertValue:function(){return this.insertControl.val()},editValue:function(){return this.editControl.val()},_createTextBox:function(){return b("<input>").attr("type","text").prop("readonly",!!this.readOnly)}});f.fields.text=f.TextField=h})(jsGrid,jQuery);
(function(f,b,l){function h(a){d.call(this,a)}var d=f.TextField;h.prototype=new d({sorter:"number",align:"right",readOnly:!1,filterValue:function(){return parseInt(this.filterControl.val()||0,10)},insertValue:function(){return parseInt(this.insertControl.val()||0,10)},editValue:function(){return parseInt(this.editControl.val()||0,10)},_createTextBox:function(){return b("<input>").attr("type","number").prop("readonly",!!this.readOnly)}});f.fields.number=f.NumberField=h})(jsGrid,jQuery);
(function(f,b,l){function h(a){d.call(this,a)}var d=f.TextField;h.prototype=new d({insertTemplate:function(){return this.inserting?this.insertControl=this._createTextArea():""},editTemplate:function(a){if(!this.editing)return this.itemTemplate(a);var b=this.editControl=this._createTextArea();b.val(a);return b},_createTextArea:function(){return b("<textarea>").prop("readonly",!!this.readOnly)}});f.fields.textarea=f.TextAreaField=h})(jsGrid,jQuery);
(function(f,b,l){function h(a){this.items=[];this.selectedIndex=-1;this.textField=this.valueField="";a.valueField&&a.items.length&&(this.valueType=typeof a.items[0][a.valueField]);this.sorter=this.valueType;d.call(this,a)}var d=f.NumberField;h.prototype=new d({align:"center",valueType:"number",itemTemplate:function(a){var e=this.items,d=this.valueField,f=this.textField,e=d?b.grep(e,function(b,e){return b[d]===a})[0]||{}:e[a],f=f?e[f]:e;return f===l||null===f?"":f},filterTemplate:function(){if(!this.filtering)return"";
var a=this._grid,b=this.filterControl=this._createSelect();if(this.autosearch)b.on("change",function(b){a.search()});return b},insertTemplate:function(){return this.inserting?this.insertControl=this._createSelect():""},editTemplate:function(a){if(!this.editing)return this.itemTemplate(a);var b=this.editControl=this._createSelect();a!==l&&b.val(a);return b},filterValue:function(){var a=this.filterControl.val();return"number"===this.valueType?parseInt(a||0,10):a},insertValue:function(){var a=this.insertControl.val();
return"number"===this.valueType?parseInt(a||0,10):a},editValue:function(){var a=this.editControl.val();return"number"===this.valueType?parseInt(a||0,10):a},_createSelect:function(){var a=b("<select>"),e=this.valueField,d=this.textField,f=this.selectedIndex;b.each(this.items,function(c,g){var h=e?g[e]:c,l=d?g[d]:g;b("<option>").attr("value",h).text(l).appendTo(a).prop("selected",f===c)});a.prop("disabled",!!this.readOnly);return a}});f.fields.select=f.SelectField=h})(jsGrid,jQuery);
(function(f,b,l){function h(a){d.call(this,a)}var d=f.Field;h.prototype=new d({sorter:"number",align:"center",autosearch:!0,itemTemplate:function(a){return this._createCheckbox().prop({checked:a,disabled:!0})},filterTemplate:function(){if(!this.filtering)return"";var a=this._grid,e=this.filterControl=this._createCheckbox();e.prop({readOnly:!0,indeterminate:!0});e.on("click",function(){var a=b(this);a.prop("readOnly")?a.prop({checked:!1,readOnly:!1}):a.prop("checked")||a.prop({readOnly:!0,indeterminate:!0})});
if(this.autosearch)e.on("click",function(){a.search()});return e},insertTemplate:function(){return this.inserting?this.insertControl=this._createCheckbox():""},editTemplate:function(a){if(!this.editing)return this.itemTemplate(a);var b=this.editControl=this._createCheckbox();b.prop("checked",a);return b},filterValue:function(){return this.filterControl.get(0).indeterminate?l:this.filterControl.is(":checked")},insertValue:function(){return this.insertControl.is(":checked")},editValue:function(){return this.editControl.is(":checked")},
_createCheckbox:function(){return b("<input>").attr("type","checkbox")}});f.fields.checkbox=f.CheckboxField=h})(jsGrid,jQuery);
(function(f,b,l){function h(a){d.call(this,a);this._configInitialized=!1}var d=f.Field;h.prototype=new d({css:"jsgrid-control-field",align:"center",width:50,filtering:!1,inserting:!1,editing:!1,sorting:!1,buttonClass:"jsgrid-button",modeButtonClass:"jsgrid-mode-button",modeOnButtonClass:"jsgrid-mode-on-button",searchModeButtonClass:"jsgrid-search-mode-button",insertModeButtonClass:"jsgrid-insert-mode-button",editButtonClass:"jsgrid-edit-button",deleteButtonClass:"jsgrid-delete-button",searchButtonClass:"jsgrid-search-button",
clearFilterButtonClass:"jsgrid-clear-filter-button",insertButtonClass:"jsgrid-insert-button",updateButtonClass:"jsgrid-update-button",cancelEditButtonClass:"jsgrid-cancel-edit-button",searchModeButtonTooltip:"Switch to searching",insertModeButtonTooltip:"Switch to inserting",editButtonTooltip:"Edit",deleteButtonTooltip:"Delete",searchButtonTooltip:"Search",clearFilterButtonTooltip:"Clear filter",insertButtonTooltip:"Insert",updateButtonTooltip:"Update",cancelEditButtonTooltip:"Cancel edit",editButton:!0,
deleteButton:!0,clearFilterButton:!0,modeSwitchButton:!0,_initConfig:function(){this._hasFiltering=this._grid.filtering;(this._hasInserting=this._grid.inserting)&&this.modeSwitchButton&&(this._grid.inserting=!1);this._configInitialized=!0},headerTemplate:function(){this._configInitialized||this._initConfig();var a=this._hasFiltering,b=this._hasInserting;return this.modeSwitchButton&&(a||b)?a&&!b?this._createFilterSwitchButton():b&&!a?this._createInsertSwitchButton():this._createModeSwitchButton():
""},itemTemplate:function(a,e){var d=b([]);this.editButton&&(d=d.add(this._createEditButton(e)));this.deleteButton&&(d=d.add(this._createDeleteButton(e)));return d},filterTemplate:function(){var a=this._createSearchButton();return this.clearFilterButton?a.add(this._createClearFilterButton()):a},insertTemplate:function(){return this._createInsertButton()},editTemplate:function(){return this._createUpdateButton().add(this._createCancelEditButton())},_createFilterSwitchButton:function(){return this._createOnOffSwitchButton("filtering",
this.searchModeButtonClass,!0)},_createInsertSwitchButton:function(){return this._createOnOffSwitchButton("inserting",this.insertModeButtonClass,!1)},_createOnOffSwitchButton:function(a,e,d){var f=d,c=b.proxy(function(){g.toggleClass(this.modeOnButtonClass,f)},this),g=this._createGridButton(this.modeButtonClass+" "+e,"",function(b){f=!f;b.option(a,f);c()});c();return g},_createModeSwitchButton:function(){var a=!1,e=b.proxy(function(){d.attr("title",a?this.searchModeButtonTooltip:this.insertModeButtonTooltip).toggleClass(this.insertModeButtonClass,
!a).toggleClass(this.searchModeButtonClass,a)},this),d=this._createGridButton(this.modeButtonClass,"",function(b){a=!a;b.option("inserting",a);b.option("filtering",!a);e()});e();return d},_createEditButton:function(a){return this._createGridButton(this.editButtonClass,this.editButtonTooltip,function(b,d){b.editItem(a);d.stopPropagation()})},_createDeleteButton:function(a){return this._createGridButton(this.deleteButtonClass,this.deleteButtonTooltip,function(b,d){b.deleteItem(a);d.stopPropagation()})},
_createSearchButton:function(){return this._createGridButton(this.searchButtonClass,this.searchButtonTooltip,function(a){a.search()})},_createClearFilterButton:function(){return this._createGridButton(this.clearFilterButtonClass,this.clearFilterButtonTooltip,function(a){a.clearFilter()})},_createInsertButton:function(){return this._createGridButton(this.insertButtonClass,this.insertButtonTooltip,function(a){a.insertItem().done(function(){a.clearInsert()})})},_createUpdateButton:function(){return this._createGridButton(this.updateButtonClass,
this.updateButtonTooltip,function(a,b){a.updateItem();b.stopPropagation()})},_createCancelEditButton:function(){return this._createGridButton(this.cancelEditButtonClass,this.cancelEditButtonTooltip,function(a,b){a.cancelEdit();b.stopPropagation()})},_createGridButton:function(a,d,f){var h=this._grid;return b("<input>").addClass(this.buttonClass).addClass(a).attr({type:"button",title:d}).on("click",function(a){f(h,a)})},editValue:function(){return""}});f.fields.control=f.ControlField=h})(jsGrid,jQuery);